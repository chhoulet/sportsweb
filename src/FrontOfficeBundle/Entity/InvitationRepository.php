<?php

namespace FrontOfficeBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * InvitationRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class InvitationRepository extends EntityRepository
{
	# Query alimentant la homepage du site:
	public function getInvitation()
	{
		$query = $this -> getEntityManager()-> createQuery('
			SELECT i 
			FROM FrontOfficeBundle:Invitation i 
			WHERE i.accepted = false
			ORDER BY i.dateCreated DESC')
		->seMaxResults(50);

		return $query -> getResult();
	}

	# Query permettant un tri des invitations par sport:
	public function sportInvitation($sport)
	{
		$query = $this -> getEntityManager()->createQuery('
			SELECT i 
			FROM FrontOfficeBundle:Invitation i 
			WHERE i.accepted = false 
			AND i.sport LIKE :sport')
		->setParameter('sport', $sport);

		return $query ->getResult();
	}

	# Query affichant les invitations acceptÃ©es par un player:
	public function seeInvitation($player)
	{
		$query = $this -> getEntityManager() -> createQuery('
			SELECT i 
			FROM FrontOfficeBundle:Invitation i 
			JOIN i.player j 
			WHERE i.accepted = true 
			AND j.username LIKE :player')
		->setParameter('player', $player);

		return $query -> getResult();
	}
}
